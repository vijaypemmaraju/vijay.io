const m=e=>history.replaceState(e,"");let l=history.state?.index||0;history.state||m({index:l,scrollY:0});const b=!!document.startViewTransition,p=()=>!!document.querySelector('[name="astro-view-transitions-enabled"]'),w=e=>document.dispatchEvent(new Event(e)),A=()=>w("astro:load"),d="data-astro-transition-persist",v=(e,t)=>{let n=!1;return(...r)=>{n||(e(...r),n=!0,setTimeout(()=>{n=!1},t))}};async function S(e){const t=await fetch(e),n=await t.text();return{ok:t.ok,html:n}}function T(){const e=document.querySelector('[name="astro-view-transitions-fallback"]');return e?e.getAttribute("content"):"animate"}function k(){for(const e of document.scripts)e.dataset.astroExec=""}function x(){let e=Promise.resolve();for(const t of Array.from(document.scripts)){if(t.dataset.astroExec==="")continue;const n=document.createElement("script");n.innerHTML=t.innerHTML;for(const r of t.attributes){if(r.name==="src"){const i=new Promise(u=>{n.onload=u});e=e.then(()=>i)}n.setAttribute(r.name,r.value)}n.dataset.astroExec="",t.replaceWith(n)}return e}const L=new DOMParser;async function E(e,t,n,r){const i=L.parseFromString(t,"text/html");i.documentElement.dataset.astroTransition=e;const u=a=>{const o=a.getAttribute(d),s=o&&i.head.querySelector(`[${d}="${o}"]`);if(s)return s;if(a.matches("link[rel=stylesheet]")){const c=a.getAttribute("href");return i.head.querySelector(`link[rel=stylesheet][href="${c}"]`)}if(a.tagName==="SCRIPT"){let c=a;for(const f of i.scripts)if(c.textContent&&c.textContent===f.textContent||c.type===f.type&&c.src===f.src)return f}return null},y=()=>{for(const o of Array.from(document.head.children)){const s=u(o);s?s.remove():o.remove()}document.head.append(...i.head.children);const a=document.body;document.body.replaceWith(i.body);for(const o of a.querySelectorAll(`[${d}]`)){const s=o.getAttribute(d),c=document.querySelector(`[${d}="${s}"]`);c&&c.replaceWith(o)}if(n?.scrollY===0&&location.hash){const o=decodeURIComponent(location.hash.slice(1));n.scrollY=document.getElementById(o)?.offsetTop||0}n?.scrollY!=null&&scrollTo(0,n.scrollY),w("astro:beforeload")},h=[];for(const a of i.querySelectorAll("head link[rel=stylesheet]"))if(!document.querySelector(`[${d}="${a.getAttribute(d)}"], link[rel=stylesheet]`)){const o=document.createElement("link");o.setAttribute("rel","preload"),o.setAttribute("as","style"),o.setAttribute("href",a.getAttribute("href")),h.push(new Promise(s=>{["load","error"].forEach(c=>o.addEventListener(c,s)),document.head.append(o)}))}if(h.length&&await Promise.all(h),r==="animate"){let a=!1;addEventListener("animationstart",()=>a=!0,{once:!0}),document.documentElement.dataset.astroTransitionFallback="old";const o=()=>{removeEventListener("animationend",o),clearTimeout(s),y(),document.documentElement.dataset.astroTransitionFallback="new"};addEventListener("animationend",o,{once:!0});let s=setTimeout(()=>!a&&o())}else y()}async function g(e,t,n){let r;const{html:i,ok:u}=await S(t);if(!u){location.href=t;return}b?r=document.startViewTransition(()=>E(e,i,n)).finished:r=E(e,i,n,T());try{await r}finally{document.documentElement.removeAttribute("data-astro-transition"),await x(),k(),A()}}function P(e){if(document.querySelector(`link[rel=prefetch][href="${e}"]`))return;if(navigator.connection){let n=navigator.connection;if(n.saveData||/(2|3)g/.test(n.effectiveType||""))return}let t=document.createElement("link");t.setAttribute("rel","prefetch"),t.setAttribute("href",e),document.head.append(t)}(b||T()!=="none")&&(k(),document.addEventListener("click",e=>{let t=e.target;if(t instanceof Element&&t.tagName!=="A"&&(t=t.closest("a")),t&&t instanceof HTMLAnchorElement&&t.href&&(!t.target||t.target==="_self")&&t.origin===location.origin&&!(location.pathname===t.pathname&&location.search===t.search)&&e.button===0&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.defaultPrevented&&p()){e.preventDefault(),g("forward",t.href,{index:l,scrollY:0}),l++;const n={index:l,scrollY};m({index:l-1,scrollY}),history.pushState(n,"",t.href)}}),addEventListener("popstate",e=>{if(!p()){location.reload();return}if(e.state===null){m({index:l,scrollY}),e.preventDefault();return}const t=history.state,n=t?.index??l+1,r=n>l?"forward":"back";g(r,location.href,t),l=n}),["mouseenter","touchstart","focus"].forEach(e=>{document.addEventListener(e,t=>{if(t.target instanceof HTMLAnchorElement){let n=t.target;n.origin===location.origin&&n.pathname!==location.pathname&&p()&&P(n.pathname)}},{passive:!0,capture:!0})}),addEventListener("load",A),addEventListener("scroll",v(()=>{history.state&&m({...history.state,scrollY})},300),{passive:!0}));
